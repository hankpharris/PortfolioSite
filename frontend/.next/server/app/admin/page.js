(()=>{var e={};e.id=3,e.ids=[3],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},73050:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>g,tree:()=>c});var a=t(7),s=t(8533),n=t(29377),i=t.n(n),o=t(29799),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let c=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,40665)),"C:\\Users\\henry\\WebstormProjects\\portfolio3\\frontend\\app\\admin\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,62718)),"C:\\Users\\henry\\WebstormProjects\\portfolio3\\frontend\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,94143)),"C:\\Users\\henry\\WebstormProjects\\portfolio3\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,97832)),"C:\\Users\\henry\\WebstormProjects\\portfolio3\\frontend\\app\\not-found.tsx"]}],d=["C:\\Users\\henry\\WebstormProjects\\portfolio3\\frontend\\app\\admin\\page.tsx"],u="/admin/page",p={require:t,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},81520:(e,r,t)=>{Promise.resolve().then(t.bind(t,75527))},98435:(e,r,t)=>{Promise.resolve().then(t.bind(t,65257)),Promise.resolve().then(t.bind(t,64851))},75527:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var a=t(54714),s=t(65164);function n({children:e}){return a.jsx(s.SessionProvider,{children:e})}},65257:(e,r,t)=>{"use strict";t.r(r),t.d(r,{ProjectsTable:()=>n});var a=t(54714),s=t(77580);function n({initialProjects:e}){let[r,t]=(0,s.useState)(e),[n,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,p]=(0,s.useState)(!1),[g,m]=(0,s.useState)({name:"",status:"Planned",overviewText:"",description:"",overviewImage1:null,overviewImage2:null,overviewImage3:null,link:null,gitHubLink:null}),x=e=>{i(e.id),l({...e})},h=async e=>{if(o)try{if(!(await fetch(`/api/projects/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw Error("Failed to update project");t(r.map(r=>r.id===e?o:r)),i(null),l(null)}catch(e){console.error("Error updating project:",e)}},v=()=>{i(null),l(null)},b=(e,r)=>{o&&l({...o,[e]:r})},y=(e,r)=>{m(t=>({...t,[e]:r}))},j=async()=>{try{let e=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!e.ok)throw Error("Failed to create project");let a=await e.json();t([...r,a]),p(!1),m({name:"",status:"Planned",overviewText:"",description:"",overviewImage1:null,overviewImage2:null,overviewImage3:null,link:null,gitHubLink:null})}catch(e){console.error("Error creating project:",e)}},w=async(e,r)=>{if(o){d(e);try{let t=new FormData;t.append("file",r);let a=await fetch("/api/upload",{method:"POST",body:t});if(!a.ok)throw Error("Failed to upload image");let{url:s}=await a.json();b(e,s)}catch(e){console.error("Error uploading image:",e)}finally{d(null)}}},f=async e=>{if(o&&o[e])try{if(!(await fetch("/api/upload",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:o[e]})})).ok)throw Error("Failed to delete image");b(e,"")}catch(e){console.error("Error deleting image:",e)}},N=async e=>{if(confirm("Are you sure you want to delete this project?"))try{if(!(await fetch(`/api/projects/${e}`,{method:"DELETE"})).ok)throw Error("Failed to delete project");t(r.filter(r=>r.id!==e))}catch(e){console.error("Error deleting project:",e)}},k=async(e,r)=>{d(e);try{let t=new FormData;t.append("file",r);let a=await fetch("/api/upload",{method:"POST",body:t});if(!a.ok)throw Error("Failed to upload image");let{url:s}=await a.json();m(r=>({...r,[e]:s}))}catch(e){console.error("Error uploading image:",e)}finally{d(null)}};return(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex justify-end",children:u?(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:j,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Create"}),a.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Cancel"})]}):a.jsx("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"New Project"})}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full bg-white dark:bg-gray-800 rounded-lg shadow",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100 dark:bg-gray-700",children:[a.jsx("th",{className:"px-4 py-2",children:"ID"}),a.jsx("th",{className:"px-4 py-2",children:"Name"}),a.jsx("th",{className:"px-4 py-2",children:"Status"}),a.jsx("th",{className:"px-4 py-2",children:"Overview"}),a.jsx("th",{className:"px-4 py-2",children:"Description"}),a.jsx("th",{className:"px-4 py-2",children:"Images"}),a.jsx("th",{className:"px-4 py-2",children:"Links"}),a.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),(0,a.jsxs)("tbody",{children:[u&&(0,a.jsxs)("tr",{className:"border-t dark:border-gray-700",children:[a.jsx("td",{className:"px-4 py-2 text-gray-600 dark:text-gray-400",children:"New"}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:g.name,onChange:e=>y("name",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"Project Name"})}),a.jsx("td",{className:"px-4 py-2",children:(0,a.jsxs)("select",{value:g.status,onChange:e=>y("status",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600",children:[a.jsx("option",{value:"InProgress",children:"In Progress"}),a.jsx("option",{value:"CompleteMaintained",children:"Complete (Maintained)"}),a.jsx("option",{value:"CompleteUnmaintained",children:"Complete (Unmaintained)"}),a.jsx("option",{value:"Planned",children:"Planned"})]})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("textarea",{value:g.overviewText||"",onChange:e=>y("overviewText",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600",rows:3,placeholder:"Overview"})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("textarea",{value:g.description||"",onChange:e=>y("description",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600",rows:3,placeholder:"Description"})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("div",{className:"space-y-2",children:["overviewImage1","overviewImage2","overviewImage3"].map(e=>(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:r=>{let t=r.target.files?.[0];t&&k(e,t)},className:"hidden",id:`new-${e}`}),a.jsx("label",{htmlFor:`new-${e}`,className:`block px-3 py-1 text-sm text-center rounded cursor-pointer
                                                        ${c===e?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:c===e?"Uploading...":"Upload Image"}),g[e]&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Current: ",g[e]]})]},e))})}),a.jsx("td",{className:"px-4 py-2",children:(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("input",{type:"text",value:g.link||"",onChange:e=>y("link",e.target.value),placeholder:"Project URL",className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600"}),a.jsx("input",{type:"text",value:g.gitHubLink||"",onChange:e=>y("gitHubLink",e.target.value),placeholder:"GitHub URL",className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600"})]})}),a.jsx("td",{className:"px-4 py-2"})]}),r.map(e=>(0,a.jsxs)("tr",{className:"border-t dark:border-gray-700",children:[a.jsx("td",{className:"px-4 py-2 text-gray-600 dark:text-gray-400",children:e.id}),a.jsx("td",{className:"px-4 py-2",children:n===e.id?a.jsx("input",{type:"text",value:o?.name||"",onChange:e=>b("name",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600"}):e.name}),a.jsx("td",{className:"px-4 py-2",children:n===e.id?(0,a.jsxs)("select",{value:o?.status||"",onChange:e=>b("status",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600",children:[a.jsx("option",{value:"InProgress",children:"In Progress"}),a.jsx("option",{value:"CompleteMaintained",children:"Complete (Maintained)"}),a.jsx("option",{value:"CompleteUnmaintained",children:"Complete (Unmaintained)"}),a.jsx("option",{value:"Planned",children:"Planned"})]}):e.status}),a.jsx("td",{className:"px-4 py-2 max-w-xs",children:n===e.id?a.jsx("textarea",{value:o?.overviewText||"",onChange:e=>b("overviewText",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600",rows:3}):a.jsx("div",{className:"truncate",children:e.overviewText})}),a.jsx("td",{className:"px-4 py-2 max-w-xs",children:n===e.id?a.jsx("textarea",{value:o?.description||"",onChange:e=>b("description",e.target.value),className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600",rows:3}):a.jsx("div",{className:"truncate",children:e.description})}),a.jsx("td",{className:"px-4 py-2",children:n===e.id?a.jsx("div",{className:"space-y-2",children:["overviewImage1","overviewImage2","overviewImage3"].map(r=>(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];t&&w(r,t)},className:"hidden",id:`${r}-${e.id}`}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("label",{htmlFor:`${r}-${e.id}`,className:`block px-3 py-1 text-sm text-center rounded cursor-pointer
                                                                ${c===r?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:c===r?"Uploading...":"Upload Image"}),o&&o[r]&&a.jsx("button",{onClick:()=>f(r),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})]}),o&&o[r]&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Current: ",o[r]]})]},r))}):(0,a.jsxs)("div",{className:"space-y-1",children:[e.overviewImage1&&a.jsx("div",{className:"truncate",children:"Image 1: ✓"}),e.overviewImage2&&a.jsx("div",{className:"truncate",children:"Image 2: ✓"}),e.overviewImage3&&a.jsx("div",{className:"truncate",children:"Image 3: ✓"})]})}),a.jsx("td",{className:"px-4 py-2",children:n===e.id?(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("input",{type:"text",value:o?.link||"",onChange:e=>b("link",e.target.value),placeholder:"Project URL",className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600"}),a.jsx("input",{type:"text",value:o?.gitHubLink||"",onChange:e=>b("gitHubLink",e.target.value),placeholder:"GitHub URL",className:"w-full p-1 border rounded dark:bg-gray-700 dark:border-gray-600"})]}):(0,a.jsxs)("div",{className:"space-y-1",children:[e.link&&a.jsx("div",{className:"truncate",children:"Project: ✓"}),e.gitHubLink&&a.jsx("div",{className:"truncate",children:"GitHub: ✓"})]})}),a.jsx("td",{className:"px-4 py-2",children:n===e.id?(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[a.jsx("button",{onClick:()=>h(e.id),className:"w-full px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"Save"}),a.jsx("button",{onClick:v,className:"w-full px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Cancel"}),a.jsx("button",{onClick:()=>N(e.id),className:"w-full px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})]}):a.jsx("button",{onClick:()=>x(e),className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Edit"})})]},e.id))]})]})})]})}},64851:(e,r,t)=>{"use strict";t.r(r),t.d(r,{SignOutButton:()=>i});var a=t(54714),s=t(65164),n=t(16151);function i(){return a.jsx(n.z,{onClick:()=>(0,s.signOut)({callbackUrl:"/"}),variant:"nav",href:"#",children:"Sign Out"})}},62718:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>n,__esModule:()=>s,default:()=>i});let a=(0,t(71481).createProxy)(String.raw`C:\Users\henry\WebstormProjects\portfolio3\frontend\app\admin\layout.tsx`),{__esModule:s,$$typeof:n}=a,i=a.default},40665:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>v});var a=t(40657),s=t(40999),n=t(78931),i=t(50268),o=t(71481);let l=(0,o.createProxy)(String.raw`C:\Users\henry\WebstormProjects\portfolio3\frontend\components\buttons\SignOutButton.tsx`),{__esModule:c,$$typeof:d}=l;l.default;let u=(0,o.createProxy)(String.raw`C:\Users\henry\WebstormProjects\portfolio3\frontend\components\buttons\SignOutButton.tsx#SignOutButton`),p=(0,o.createProxy)(String.raw`C:\Users\henry\WebstormProjects\portfolio3\frontend\components\admin\ProjectsTable.tsx`),{__esModule:g,$$typeof:m}=p;p.default;let x=(0,o.createProxy)(String.raw`C:\Users\henry\WebstormProjects\portfolio3\frontend\components\admin\ProjectsTable.tsx#ProjectsTable`);var h=t(5346);async function v(){let e=await (0,s.getServerSession)(i.L);e||(0,n.redirect)("/api/auth/signin");let r=await (0,h.mW)();return(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Admin Panel"}),a.jsx(u,{})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow mb-8",children:[(0,a.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Welcome to the admin panel. You are currently authenticated as: ",a.jsx("span",{className:"font-semibold",children:e.user?.name})]}),a.jsx("p",{className:"text-green-600 dark:text-green-400",children:"✓ Authentication successful - You have full access to this area"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Projects"}),a.jsx(x,{initialProjects:r})]})]})}},50268:(e,r,t)=>{"use strict";t.d(r,{L:()=>n});var a=t(68152);let s=(e,r)=>{let t=e.replace(/\/$/,"");return`${t}/api/auth/callback/${r}`};console.log("Vercel callback URL:",s(process.env.NEXTAUTH_URL_INTERNAL,"github-vercel")),console.log("Personal callback URL:",s(process.env.NEXTAUTH_URL,"github-personal"));let n={providers:[(0,a.Z)({id:"github-vercel",clientId:process.env.GITHUB_ID,clientSecret:process.env.GITHUB_SECRET,authorization:{params:{redirect_uri:s(process.env.NEXTAUTH_URL_INTERNAL,"github-vercel")}}}),(0,a.Z)({id:"github-personal",clientId:process.env.GITHUB_ID_PERSONAL,clientSecret:process.env.GITHUB_SECRET_PERSONAL,authorization:{params:{redirect_uri:s(process.env.NEXTAUTH_URL,"github-personal")}}})],callbacks:{async signIn({user:e,account:r}){if(console.log("Sign in attempt with provider:",r?.provider),console.log("Callback URL:",r?.redirect_uri),r?.provider==="github-vercel"||r?.provider==="github-personal"){let e=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${r.access_token}`}}),t=await e.json();return(process.env.ALLOWED_GITHUB_USERS?.split(",")||[]).map(e=>e.trim()).includes(t.login)}return!1},jwt:async({token:e,user:r,account:t})=>(r&&(e.role="admin"),e),session:async({session:e,token:r})=>(e?.user&&(e.user.role=r.role),e)},pages:{signIn:"/auth/signin"},debug:!0,cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:!0}}}}},5346:(e,r,t)=>{"use strict";t.d(r,{e5:()=>l,mW:()=>c,ty:()=>d});var a=t(90236),s=t(50033);let n={DATABASE_URL:process.env.DATABASE_URL},i=Object.entries(n).filter(([e,r])=>!r).map(([e])=>e);if(i.length>0)throw Error(`Missing required environment variables: ${i.join(", ")}. Please check your .env file and ensure all required variables are set.`);let o=n.DATABASE_URL;async function l(e){try{console.log("Fetching project with ID:",e);let r=(0,a.qn)(o),t=await r`
            SELECT 
                id,
                name,
                status,
                "overviewText",
                description,
                "overviewImage1",
                "overviewImage2",
                "overviewImage3",
                link,
                "gitHubLink"
            FROM "Project" 
            WHERE id = ${parseInt(e)}
        `;if(console.log("Query result:",t),!t||0===t.length)return console.log("No project found with ID:",e),null;let n=t[0];console.log("Raw project data:",n);let i=s.PH.parse(n);return console.log("Validated project:",i),i}catch(e){return console.error("Error in getProject:",e),null}}async function c(){try{console.log("Fetching all projects");let e=(0,a.qn)(o),r=await e`
            SELECT 
                id,
                name,
                status,
                "overviewText",
                description,
                "overviewImage1",
                "overviewImage2",
                "overviewImage3",
                link,
                "gitHubLink"
            FROM "Project" 
            ORDER BY id ASC
        `;if(console.log("Query result:",r),!r||0===r.length)return console.log("No projects found"),[];let t=r.map(e=>{try{return s.PH.parse(e)}catch(r){return console.error("Error validating project:",e,r),null}}).filter(e=>null!==e);return console.log("Validated projects:",t),t}catch(e){return console.error("Error in getProjects:",e),[]}}async function d(e,r){let t=(0,a.qn)(o),n=await t`
        UPDATE "Project"
        SET 
            name = ${r.name},
            status = ${r.status},
            "overviewText" = ${r.overviewText},
            description = ${r.description},
            "overviewImage1" = ${r.overviewImage1},
            "overviewImage2" = ${r.overviewImage2},
            "overviewImage3" = ${r.overviewImage3},
            link = ${r.link},
            "gitHubLink" = ${r.gitHubLink}
        WHERE id = ${e}
        RETURNING id, name, status, "overviewText", description, "overviewImage1", "overviewImage2", "overviewImage3", link, "gitHubLink"
    `;if(!n||0===n.length)throw Error("Project not found");let i=n[0],l=s.PH.safeParse(i);if(!l.success)throw console.warn("Project validation failed:",l.error),Error("Invalid project data");return l.data}},50033:(e,r,t)=>{"use strict";t.d(r,{PH:()=>n});var a=t(78024);let s=a.z.enum(["InProgress","CompleteMaintained","CompleteUnmaintained","Planned"]),n=a.z.object({id:a.z.number().int().positive(),name:a.z.string().min(1).max(100),status:s,overviewText:a.z.string().max(2e3).nullable(),description:a.z.string().max(5e3).nullable(),overviewImage1:a.z.string().nullable(),overviewImage2:a.z.string().nullable(),overviewImage3:a.z.string().nullable(),link:a.z.string().nullable(),gitHubLink:a.z.string().nullable()});a.z.string().regex(/^\d+$/).transform(Number)}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[499,800,236,24,823,718,164,293],()=>t(73050));module.exports=a})();